generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model device {
  device_id            Int                 @id
  device_name          String?             @default("未命名設備") @db.VarChar(50)
  location_description String?             @db.VarChar(50)
  longitude            Float?
  latitude             Float?
  status               DeviceStatus?       @default(LOCATION_UNKNOWN)
  appearance_records   appearance_record[] @relation("DeviceToAppearanceRecord")
}

model species {
  species_id         Int                 @id @default(autoincrement())
  species_name       String              @db.VarChar(100)
  appearance_records appearance_record[] @relation("SpeciesToAppearanceRecord")
}

model appearance_record {
  record_id       Int       @id @default(autoincrement())
  device_id       Int
  species_id      Int
  count           Int       @default(1)
  average_speed   Float?
  appearance_time DateTime  @default(now())
  leave_time      DateTime?
  device          device    @relation("DeviceToAppearanceRecord", fields: [device_id], references: [device_id])
  species         species   @relation("SpeciesToAppearanceRecord", fields: [species_id], references: [species_id])

  @@index([device_id], map: "appearance_record_device_id_fkey")
  @@index([species_id], map: "appearance_record_species_id_fkey")
}

enum DeviceStatus {
  ONLINE
  OFFLINE
  LOCATION_UNKNOWN
}
